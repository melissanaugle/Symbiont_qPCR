dat <- rbind(dat1,dat2)
nrow(dat)
#remove and replace with redos
dat<-dat[!(dat$Sample=="Alu_F2" | dat$Sample=="TeleF5" | dat$Sample=="VatiaF6"),]
dat3 <- dat3[!(dat3$Sample=="AluF4"),]
dat3$Starting.Quantity..SQ. <- NULL
dat <- rbind(dat,dat3)
head(dat)
dat$FAM <- as.numeric(dat$FAM)
dat$VIC <- as.numeric(dat$VIC)
dat <- dat[!(dat$Sample=="NC"),]
dat$Site = "n"
dat <- mutate(dat, Site = derivedFactor(
"Faga'tele" = (grepl("Tele", dat$Sample)),
"Faga'alu" = (grepl("Alu", dat$Sample)),
"Vatia" = (grepl("Vat", dat$Sample)),
"Cannery" = (grepl("Can", dat$Sample)),
"Coconut Point" = (grepl("Coco", dat$Sample)),
"Neg Control" = (grepl("ontrol", dat$Sample)),
method ="first",
.default = NA
))
dat <- dat[!(dat$Site == "Neg Control"),]
#try log transforming ct values first, then calc after
dat_log <- dat
dat_log$FAM_log <- log10(dat_log$FAM)
dat_log$VIC_log <- log10(dat_log$VIC)
dat_ratio_log <- dat_log %>%
group_by(Sample, Site) %>%
summarize(FAM_log_mean = mean(FAM_log, na.rm = TRUE), VIC_log_mean = mean(VIC_log, na.rm = TRUE))
dat_ratio_log
dat_ratio_log$cellnum_C <- (2^(40 - dat_ratio_log$VIC_log_mean)) / 9
dat_ratio_log$cellnum_C[is.na(dat_ratio_log$VIC_log_mean)] <- (2^(40-10000000000000))
dat_ratio_log$cellnum_D <- (2^(40 - dat_ratio_log$FAM_log_mean)) / 1
dat_ratio_log$D_prop <- dat_ratio_log$cellnum_D / (dat_ratio_log$cellnum_C + dat_ratio_log$cellnum_D)
dat_ratio_log$C_prop <- dat_ratio_log$cellnum_C / (dat_ratio_log$cellnum_C + dat_ratio_log$cellnum_D)
dat_ratio_gather <- gather(dat_ratio_log, "Species", "Ratio", 7:8)
dat_ratio_gather$Ratio <- round(dat_ratio_gather$Ratio, digits = 4)
dat_ratio_log$Site <- factor(dat_ratio_log$Site, levels = c("Cannery", "Coconut Point", "Faga'alu", "Vatia" ,"Faga'tele"))
ggplot(dat_ratio_log, aes(x = Site, y = C_prop, fill = Site)) + geom_violin() + theme_bw()  +
scale_fill_brewer(palette = "Set3") + ylab("Log Proportion of Cladocopium") + xlab("") + geom_dotplot(binaxis='y', stackdir='center', dotsize=0.1, binwidth = 0.04)
#ggsave("figures/symbionts_cprop_03_25_21.pdf", width = 6, height = 4)
dat_ratio_means <- dat_ratio_log %>%
group_by(Site) %>%
summarize(D_prop_avg = mean(D_prop), C_prop_avg = mean(C_prop))
dat_ratio_means <- gather(dat_ratio_means, "Species", "Ratio", 2:3)
dat_ratio_means$logRatio <- dat_ratio_means$Ratio
dat_ratio_means$Site <- factor(dat_ratio_means$Site, levels = c("Cannery", "Coconut Point", "Faga'alu", "Vatia" ,"Faga'tele"))
#plots mean proportions for each site
ggplot(dat_ratio_means, aes(x = Site, y = logRatio, fill = Species)) + geom_col() + theme_bw()  + ylab("Log Proportion of Durisdinium and Cladocopium") + scale_fill_manual(labels = c("Cladocopium", "Durisdinium"), values = c("violetred2", "royalblue3")) + xlab("") + theme(legend.title = element_blank())
#ggsave("figures/symbionts_logratio_03_25_21.pdf", width = 6, height = 4)
dat_ratio_means
dat_ratio_log
write.csv(dat_ratio_log, "/Users/Melissa/Desktop/GitHub/Symbiont_qPCR/cleandata/symbiont_log_ratios.csv", row.names = F)
#no assumptions met
dat_ratio_log$CDratio_log <- dat_ratio_log$cellnum_C/dat_ratio_log$cellnum_D
shapiro.test(dat_ratio_log$CDratio_log)
#not normal
#p = 1.2e-09
shapiro.test(dat_ratio_log$cellnum_D)
shapiro.test(dat_ratio_log$C_prop)
shapiro.test(dat_ratio_log$D_prop)
bartlett.test(CDratio_log ~ Site, data=dat_ratio_log)
#not equal
#p < 2.2e-16
modelCD = lm(CD_ratio ~ Site, data=dat_ratio)
modelCD = lm(CD_ratio ~ Site, data=dat_ratio_log)
dat_ratio_log
dat_ratio
dat_ratio_log
modelCD = lm(CD_ratio_log ~ Site, data=dat_ratio_log)
dat_ratio_log
modelCD = lm(CDratio_log ~ Site, data=dat_ratio_log)
anova(modelCD)
#very signif
shapiro.test(modelCD$residuals)
#not normal
TukeyHSD(modelCD,"Site")
dat_ratio <- dat %>%
group_by(Sample, Site) %>%
summarize(FAM_mean = mean(FAM, na.rm = TRUE), VIC_mean = mean(VIC, na.rm = TRUE))
head(dat_ratio)
#not the proper ratio but hehe oh well
dat_ratio$CD_ratio <- (dat_ratio$FAM_mean / dat_ratio$VIC_mean)
dat_ratio$CD_ratio[is.na(dat_ratio$CD_ratio)] <- 0
#maybe look at qPCR for other spp to calc ratios
#need to log transform
#how did tom calc ratios - try to get within same range ?
#The proportion of clade D in each colony was then calculated as D cells/(C cells + D cells), with the number of cells of each clade calculated as 2^(40-avg. CT) divided by the gene copy numbers (Cunning and Baker 2012). from cunning 2013 pf 110
#prop of D
#copy num = 9 and 1 for C and D
dat_ratio$cellnum_C <- (2^(40 - dat_ratio$VIC_mean)) / 9
dat_ratio$cellnum_C[is.na(dat_ratio$cellnum_C)] <- (2^(40-10000000000000))
dat_ratio$cellnum_D <- (2^(40 - dat_ratio$FAM_mean)) / 1
dat_ratio$D_prop <- dat_ratio$cellnum_D / (dat_ratio$cellnum_C + dat_ratio$cellnum_D)
dat_ratio$C_prop <- dat_ratio$cellnum_C / (dat_ratio$cellnum_C + dat_ratio$cellnum_D)
dat_ratio_gather <- gather(dat_ratio, "Species", "Ratio", 7:8)
dat_ratio_gather$Ratio <- round(dat_ratio_gather$Ratio, digits = 4)
ggplot(dat_ratio, aes(x = Site, y = C_prop, fill = Site)) + geom_boxplot() + theme_bw() +
geom_dotplot(binaxis='y', stackdir='center', dotsize=1, binwidth = 0.04) +
scale_fill_brewer(palette = "Set3") + ylab("Log Proportion of Cladocopium") + xlab("") + scale_y_continuous(trans = 'log10')
dat_ratio <- dat %>%
group_by(Sample, Site) %>%
summarize(FAM_mean = mean(FAM, na.rm = TRUE), VIC_mean = mean(VIC, na.rm = TRUE))
head(dat_ratio)
#not the proper ratio but hehe oh well
dat_ratio$CD_ratio <- (dat_ratio$FAM_mean / dat_ratio$VIC_mean)
dat_ratio$CD_ratio[is.na(dat_ratio$CD_ratio)] <- 0
#maybe look at qPCR for other spp to calc ratios
#need to log transform
#how did tom calc ratios - try to get within same range ?
#The proportion of clade D in each colony was then calculated as D cells/(C cells + D cells), with the number of cells of each clade calculated as 2^(40-avg. CT) divided by the gene copy numbers (Cunning and Baker 2012). from cunning 2013 pf 110
#prop of D
#copy num = 9 and 1 for C and D
dat_ratio$cellnum_C <- (2^(40 - dat_ratio$VIC_mean)) / 9
dat_ratio$cellnum_C[is.na(dat_ratio$cellnum_C)] <- (2^(40-10000000000000))
dat_ratio$cellnum_D <- (2^(40 - dat_ratio$FAM_mean)) / 1
dat_ratio$D_prop <- dat_ratio$cellnum_D / (dat_ratio$cellnum_C + dat_ratio$cellnum_D)
dat_ratio$C_prop <- dat_ratio$cellnum_C / (dat_ratio$cellnum_C + dat_ratio$cellnum_D)
dat_ratio_gather <- gather(dat_ratio, "Species", "Ratio", 7:8)
dat_ratio_gather$Ratio <- round(dat_ratio_gather$Ratio, digits = 4)
ggplot(dat_ratio, aes(x = Site, y = C_prop, fill = Site)) + geom_boxplot() + theme_bw() +
geom_dotplot(binaxis='y', stackdir='center', dotsize=1, binwidth = 0.04) +
scale_fill_brewer(palette = "Set3") + ylab("Log Proportion of Cladocopium") + xlab("") + scale_y_continuous(trans = 'log10')
ggplot(dat_ratio, aes(x = Site, y = C_prop, fill = Site)) + geom_violin() + theme_bw() +
geom_dotplot(binaxis='y', stackdir='center', dotsize=1, binwidth = 0.04) +
scale_fill_brewer(palette = "Set3") + ylab("Log Proportion of Cladocopium") + xlab("") + scale_y_continuous(trans = 'log10')
#try log transforming ct values first, then calc after
dat_log <- dat
dat_log$FAM_log <- log10(dat_log$FAM)
dat_log$VIC_log <- log10(dat_log$VIC)
dat_ratio_log <- dat_log %>%
group_by(Sample, Site) %>%
summarize(FAM_log_mean = mean(FAM_log, na.rm = TRUE), VIC_log_mean = mean(VIC_log, na.rm = TRUE))
dat_ratio_log
dat_ratio_log$cellnum_C <- (2^(40 - dat_ratio_log$VIC_log_mean)) / 9
dat_ratio_log$cellnum_C[is.na(dat_ratio_log$VIC_log_mean)] <- (2^(40-10000000000000))
dat_ratio_log$cellnum_D <- (2^(40 - dat_ratio_log$FAM_log_mean)) / 1
dat_ratio_log$D_prop <- dat_ratio_log$cellnum_D / (dat_ratio_log$cellnum_C + dat_ratio_log$cellnum_D)
dat_ratio_log$C_prop <- dat_ratio_log$cellnum_C / (dat_ratio_log$cellnum_C + dat_ratio_log$cellnum_D)
dat_ratio_gather <- gather(dat_ratio_log, "Species", "Ratio", 7:8)
dat_ratio_gather$Ratio <- round(dat_ratio_gather$Ratio, digits = 4)
dat_ratio_log$Site <- factor(dat_ratio_log$Site, levels = c("Cannery", "Coconut Point", "Faga'alu", "Vatia" ,"Faga'tele"))
ggplot(dat_ratio_log, aes(x = Site, y = C_prop, fill = Site)) + geom_violin() + theme_bw()  +
scale_fill_brewer(palette = "Set3") + ylab("Log Proportion of Cladocopium") + xlab("") + geom_dotplot(binaxis='y', stackdir='center', dotsize=0.1, binwidth = 0.04)
#ggsave("figures/symbionts_cprop_03_25_21.pdf", width = 6, height = 4)
#write.csv(dat_ratio_log, "/Users/Melissa/Desktop/GitHub/Symbiont_qPCR/cleandata/symbiont_log_ratios.csv", row.names = F)
dat_ratio_means <- dat_ratio_log %>%
group_by(Site) %>%
summarize(D_prop_avg = mean(D_prop), C_prop_avg = mean(C_prop))
dat_ratio_means <- gather(dat_ratio_means, "Species", "Ratio", 2:3)
dat_ratio_means$logRatio <- dat_ratio_means$Ratio
dat_ratio_means$Site <- factor(dat_ratio_means$Site, levels = c("Cannery", "Coconut Point", "Faga'alu", "Vatia" ,"Faga'tele"))
#plots mean proportions for each site
ggplot(dat_ratio_means, aes(x = Site, y = logRatio, fill = Species)) + geom_col() + theme_bw()  + ylab("Log Proportion of Durisdinium and Cladocopium") + scale_fill_manual(labels = c("Cladocopium", "Durisdinium"), values = c("violetred2", "royalblue3")) + xlab("") + theme(legend.title = element_blank())
#ggsave("figures/symbionts_logratio_03_25_21.pdf", width = 6, height = 4)
symbionts <- read.csv("cleandata/symbiont_log_ratios.csv")
setwd(dir = "~/Desktop/GitHub/CBASS_bleachingdata/")
rm( list = ls())
graphics.off()
library(ggplot2)
library(ggpubr)
require(plyr)
library(dplyr)
library(corrplot)
temp_stats_lengthstandardized <- read.csv("Field HOBO data/temp_stats_lengthstandardized.csv")
setwd(dir = "~/Desktop/GitHub/CBASS_bleachingdata/")
rm( list = ls())
graphics.off()
library(ggplot2)
library(ggpubr)
require(plyr)
library(dplyr)
library(corrplot)
temp_stats_lengthstandardized <- read.csv("/Users/Melissa/Desktop/GitHub/CBASS_bleachingdata/Field HOBO data/temp_stats_lengthstandardized.csv")
temp_stats_lengthstandardized <- read.csv("/Users/Melissa/Desktop/GitHub/CBASS_bleachingdata/Field HOBO data/temp_stats_lengthstandardized.csv")
temp_stats_full <- read.csv("/Users/Melissa/Desktop/GitHub/CBASS_bleachingdata/Field HOBO data/temp_stats_full.csv")
pam <- read.csv("/Users/Melissa/Desktop/GitHub/CBASS_bleachingdata/raw data sheets/PAM_data_normalized.csv")
avgred <- read.csv("/Users/Melissa/Desktop/GitHub/CBASS_bleachingdata/raw data sheets/AverageRedData_normalized.csv")
symbionts <- read.csv("/Users/Melissa/Desktop/GitHub/Symbiont_qPCR/cleandata/symbiont_log_ratios.csv")
temp_stats_full
pam <- read.csv("/Users/Melissa/Desktop/GitHub/CBASS_bleachingdata/raw data sheets/PAM_data_normalized.csv")
pam
symbionts
symbionts$Colony <- parse(symbionts$Sample, "F")
symbionts$Colony <- strsplit(symbionts$Sample, "F")
symbionts$Colony <- strsplit("symbionts$Sample", "F")
symbionts
symbionts$Colony <- strsplit(symbionts$Sample, "F")
symbionts$Colony <- strsplit(as.character(symbionts$Sample), "F")
symbionts
symbionts$Colony <- strsplit(as.character(symbionts$Sample), "F", fixed = T)
symbionts
Colony <- data.frame(do.call('rbind', strsplit(as.character(symbionts$Sample), "F", fixed = T)))
Colony
symbionts$Colony <- Colony$X2
symbionts
pam
avgred
pam$SiteColony <- paste(pam$Site, pam$Colony)
pam
avgred$SiteColony <- paste(avgred$Site, avgred$Colony)
symbionts$SiteColony <- paste(symbionts$Site, symbionts$Colony)
data <- merge(pam, avgred, all = T)
data
nrow(pam)
nrow(pam)
nrow(avgred)
nrow(data)
data <- merge(data, symbionts, all = T)
nrow(data)
data
pam
pam <- select(pam, "SiteColony", "t35_normalizedto28")
pam
avgred
pam$t35_normalizedto28_pam <- pam$t35_normalizedto28
pam <- select(pam, "SiteColony", "t35_normalizedto28_pam")
avgred$t35_normalizedto28_avgred <- avgred$t35_normalizedto28
symbionts
setwd(dir = "~/Desktop/GitHub/CBASS_bleachingdata/")
rm( list = ls())
graphics.off()
library(ggplot2)
library(ggpubr)
require(plyr)
library(dplyr)
library(corrplot)
pam <- read.csv("/Users/Melissa/Desktop/GitHub/CBASS_bleachingdata/raw data sheets/PAM_data_normalized.csv")
pam$SiteColony <- paste(pam$Site, pam$Colony)
pam$t35_normalizedto28_pam <- pam$t35_normalizedto28
pam <- select(pam, "SiteColony", "t35_normalizedto28_pam")
avgred <- read.csv("/Users/Melissa/Desktop/GitHub/CBASS_bleachingdata/raw data sheets/AverageRedData_normalized.csv")
avgred$SiteColony <- paste(avgred$Site, avgred$Colony)
avgred$t35_normalizedto28_avgred <- avgred$t35_normalizedto28
avgred <- select(avgred, "SiteColony", "t35_normalizedto28_avgred")
symbionts <- read.csv("/Users/Melissa/Desktop/GitHub/Symbiont_qPCR/cleandata/symbiont_log_ratios.csv")
#add colony number to symbiont sheet
Colony <- data.frame(do.call('rbind', strsplit(as.character(symbionts$Sample), "F", fixed = T)))
symbionts$Colony <- Colony$X2
symbionts$SiteColony <- paste(symbionts$Site, symbionts$Colony)
symbionts <- select(symbionts, "SiteColony", "D_prop", "C_prop", "cellnum_D", "cellnum_C")
data <- merge(pam, avgred, all = T)
data <- merge(data, symbionts, all = T)
setwd(dir = "~/Desktop/GitHub/Symbiont_qPCR/")
rm( list = ls())
graphics.off()
library(ggplot2)
library(ggpubr)
require(plyr)
library(dplyr)
library(corrplot)
pam <- read.csv("/Users/Melissa/Desktop/GitHub/CBASS_bleachingdata/raw data sheets/PAM_data_normalized.csv")
pam$SiteColony <- paste(pam$Site, pam$Colony)
pam$t35_normalizedto28_pam <- pam$t35_normalizedto28
pam <- select(pam, "SiteColony", "t35_normalizedto28_pam")
avgred <- read.csv("/Users/Melissa/Desktop/GitHub/CBASS_bleachingdata/raw data sheets/AverageRedData_normalized.csv")
avgred$SiteColony <- paste(avgred$Site, avgred$Colony)
avgred$t35_normalizedto28_avgred <- avgred$t35_normalizedto28
avgred <- select(avgred, "SiteColony", "t35_normalizedto28_avgred")
symbionts <- read.csv("/Users/Melissa/Desktop/GitHub/Symbiont_qPCR/cleandata/symbiont_log_ratios.csv")
#add colony number to symbiont sheet
Colony <- data.frame(do.call('rbind', strsplit(as.character(symbionts$Sample), "F", fixed = T)))
symbionts$Colony <- Colony$X2
symbionts$SiteColony <- paste(symbionts$Site, symbionts$Colony)
symbionts <- select(symbionts, "SiteColony", "D_prop", "C_prop", "cellnum_D", "cellnum_C")
data <- merge(pam, avgred, all = T)
data <- merge(data, symbionts, all = T)
data
pam <- pam %>%
group_by(SiteColony) %>%
summarise(mean_t35_normalizedto28_pam = mean(t35_normalizedto28_pam))
pam
avgred <- avgred %>%
group_by(SiteColony) %>%
summarise(mean_t35_normalizedto28_avgred = mean(t35_normalizedto28_avgred))
setwd(dir = "~/Desktop/GitHub/Symbiont_qPCR/")
rm( list = ls())
graphics.off()
library(ggplot2)
library(ggpubr)
require(plyr)
library(dplyr)
library(corrplot)
pam <- read.csv("/Users/Melissa/Desktop/GitHub/CBASS_bleachingdata/raw data sheets/PAM_data_normalized.csv")
pam$SiteColony <- paste(pam$Site, pam$Colony)
pam$t35_normalizedto28_pam <- pam$t35_normalizedto28
pam <- select(pam, "SiteColony", "t35_normalizedto28_pam")
pam <- pam %>%
group_by(SiteColony) %>%
summarise(mean_t35_normalizedto28_pam = mean(t35_normalizedto28_pam))
avgred <- read.csv("/Users/Melissa/Desktop/GitHub/CBASS_bleachingdata/raw data sheets/AverageRedData_normalized.csv")
avgred$SiteColony <- paste(avgred$Site, avgred$Colony)
avgred$t35_normalizedto28_avgred <- avgred$t35_normalizedto28
avgred <- select(avgred, "SiteColony", "t35_normalizedto28_avgred")
avgred <- avgred %>%
group_by(SiteColony) %>%
summarise(mean_t35_normalizedto28_avgred = mean(t35_normalizedto28_avgred))
symbionts <- read.csv("/Users/Melissa/Desktop/GitHub/Symbiont_qPCR/cleandata/symbiont_log_ratios.csv")
#add colony number to symbiont sheet
Colony <- data.frame(do.call('rbind', strsplit(as.character(symbionts$Sample), "F", fixed = T)))
symbionts$Colony <- Colony$X2
symbionts$SiteColony <- paste(symbionts$Site, symbionts$Colony)
symbionts <- select(symbionts, "SiteColony", "D_prop", "C_prop", "cellnum_D", "cellnum_C")
data <- merge(pam, avgred, all = T)
data <- merge(data, symbionts, all = T)
data
p1 = ggplot(data, aes(x=C_prop)) + geom_line(aes(y=mean_t35_normalizedto28_pam), color="blue") + xlab("C_prop") + ylab("PAM") + theme_bw()
p2 = ggplot(data, aes(x=C_prop)) + geom_line(aes(y=mean_t35_normalizedto28_avgred), color="blue") + xlab("C_prop") + ylab("Mean Average Red") + theme_bw()
ggarrange(p1,p2)
p1 = ggplot(data, aes(x=C_prop)) + geom_line(aes(y=mean_t35_normalizedto28_pam), color="blue") + xlab("C_prop") + ylab("PAM") + theme_bw() + geom_point()
p2 = ggplot(data, aes(x=C_prop)) + geom_line(aes(y=mean_t35_normalizedto28_avgred), color="blue") + xlab("C_prop") + ylab("Mean Average Red") + theme_bw()
ggarrange(p1,p2)
p1 = ggplot(data, aes(x=C_prop)) + geom_line(aes(y=mean_t35_normalizedto28_pam), color="blue") + xlab("C_prop") + ylab("PAM") + theme_bw() + geom_dotplot(binaxis='y', stackdir='center', dotsize=0.1, binwidth = 0.04)
p2 = ggplot(data, aes(x=C_prop)) + geom_line(aes(y=mean_t35_normalizedto28_avgred), color="blue") + xlab("C_prop") + ylab("Mean Average Red") + theme_bw()
ggarrange(p1,p2)
p1 = ggplot(data, aes(x=C_prop)) + geom_line(aes(y=mean_t35_normalizedto28_pam), color="blue") + xlab("C_prop") + ylab("PAM") + theme_bw() + geom_dotplot(binaxis='y', stackdir='center')
ggarrange(p1,p2)
p1 = ggplot(data, aes(x=C_prop)) + geom_line(aes(y=mean_t35_normalizedto28_pam), color="blue") + xlab("C_prop") + ylab("PAM") + theme_bw() + geom_dotplot(aes(x=C_prop))
p2 = ggplot(data, aes(x=C_prop)) + geom_line(aes(y=mean_t35_normalizedto28_avgred), color="blue") + xlab("C_prop") + ylab("Mean Average Red") + theme_bw()
ggarrange(p1,p2)
p1 = ggplot(data, aes(x=C_prop)) + geom_line(aes(y=mean_t35_normalizedto28_pam), color="blue") + xlab("C_prop") + ylab("PAM") + theme_bw()
p2 = ggplot(data, aes(x=C_prop)) + geom_line(aes(y=mean_t35_normalizedto28_avgred), color="blue") + xlab("C_prop") + ylab("Mean Average Red") + theme_bw()
p3 = ggplot(data, aes(x=cellnum_C)) + geom_line(aes(y=mean_t35_normalizedto28_pam), color="blue") + xlab("C_prop") + ylab("PAM") + theme_bw()
p4 = ggplot(data, aes(x=cellnum_C)) + geom_line(aes(y=mean_t35_normalizedto28_avgred), color="blue") + xlab("C_prop") + ylab("Mean Average Red") + theme_bw()
ggarrange(p1,p2,p3,p4)
p3 = ggplot(data, aes(x=cellnum_C/cellnum_D)) + geom_line(aes(y=mean_t35_normalizedto28_pam), color="blue") + xlab("C_prop") + ylab("PAM") + theme_bw()
p4 = ggplot(data, aes(x=cellnum_C/cellnum_D)) + geom_line(aes(y=mean_t35_normalizedto28_avgred), color="blue") + xlab("C_prop") + ylab("Mean Average Red") + theme_bw()
ggarrange(p1,p2,p3,p4)
p1 = ggplot(data, aes(x=C_prop)) + geom_line(aes(y=mean_t35_normalizedto28_pam), color="blue") + xlab("C_prop") + ylab("PAM") + theme_bw() + xlim(0.00001, 0.1)
p2 = ggplot(data, aes(x=C_prop)) + geom_line(aes(y=mean_t35_normalizedto28_avgred), color="blue") + xlab("C_prop") + ylab("Mean Average Red") + theme_bw()
ggarrange(p1,p2)
p1 = ggplot(data, aes(x=C_prop)) + geom_line(aes(y=mean_t35_normalizedto28_pam), color="blue") + xlab("C_prop") + ylab("PAM") + theme_bw() + xlim(0.0000000000001, 0.1)
ggarrange(p1,p2)
p2 = ggplot(data, aes(x=C_prop)) + geom_line(aes(y=mean_t35_normalizedto28_avgred), color="blue") + xlab("C_prop") + ylab("Mean Average Red") + theme_bw()  + xlim(0.0000000000001, 0.1)
ggarrange(p1,p2)
p1 = ggplot(data, aes(x=C_prop)) + geom_line(aes(y=mean_t35_normalizedto28_pam), color="blue") + xlab("C_prop") + ylab("PAM") + theme_bw() + xlim(0.01, 0.1)
p2 = ggplot(data, aes(x=C_prop)) + geom_line(aes(y=mean_t35_normalizedto28_avgred), color="blue") + xlab("C_prop") + ylab("Mean Average Red") + theme_bw()  + xlim(0.01, 0.1)
ggarrange(p1,p2)
p1 = ggplot(data, aes(x=C_prop)) + geom_line(aes(y=mean_t35_normalizedto28_pam), color="blue") + xlab("C_prop") + ylab("PAM") + theme_bw() + xlim(0.05, 0.1)
p2 = ggplot(data, aes(x=C_prop)) + geom_line(aes(y=mean_t35_normalizedto28_avgred), color="blue") + xlab("C_prop") + ylab("Mean Average Red") + theme_bw()  + xlim(0.05, 0.1)
ggarrange(p1,p2)
p2 = ggplot(data, aes(x=C_prop)) + geom_line(aes(y=mean_t35_normalizedto28_avgred), color="blue") + xlab("C_prop") + ylab("Mean Average Red") + theme_bw()  + xlim(0.08, 0.1)
ggarrange(p1,p2)
p1 = ggplot(data, aes(x=C_prop)) + geom_line(aes(y=mean_t35_normalizedto28_pam), color="blue") + xlab("C_prop") + ylab("PAM") + theme_bw() + xlim(0.08, 0.1)
p2 = ggplot(data, aes(x=C_prop)) + geom_line(aes(y=mean_t35_normalizedto28_avgred), color="blue") + xlab("C_prop") + ylab("Mean Average Red") + theme_bw()  + xlim(0.08, 0.1)
ggarrange(p1,p2)
p1 = ggplot(data, aes(x=C_prop)) + geom_line(aes(y=mean_t35_normalizedto28_pam), color="blue") + xlab("C_prop") + ylab("PAM") + theme_bw() + xlim(0.085, 0.1)
p2 = ggplot(data, aes(x=C_prop)) + geom_line(aes(y=mean_t35_normalizedto28_avgred), color="blue") + xlab("C_prop") + ylab("Mean Average Red") + theme_bw()  + xlim(0.085, 0.1)
ggarrange(p1,p2)
p1 = ggplot(data, aes(x=C_prop)) + geom_line(aes(y=mean_t35_normalizedto28_pam), color="blue") + xlab("C_prop") + ylab("PAM") + theme_bw() + xlim(0.085, 0.1) + ylim(-0.1,0.05)
p2 = ggplot(data, aes(x=C_prop)) + geom_line(aes(y=mean_t35_normalizedto28_avgred), color="blue") + xlab("C_prop") + ylab("Mean Average Red") + theme_bw()  + xlim(0.085, 0.1)
ggarrange(p1,p2)
p1 = ggplot(data, aes(x=C_prop)) + geom_line(aes(y=mean_t35_normalizedto28_pam), color="blue") + xlab("C_prop") + ylab("PAM") + theme_bw() + xlim(0.085, 0.1) + ylim(-0.1,0.05) + geom_dotplot()
ggarrange(p1,p2)
p1 = ggplot(data, aes(x=C_prop)) + geom_line(aes(y=mean_t35_normalizedto28_pam), color="blue") + xlab("C_prop") + ylab("PAM") + theme_bw() + xlim(0.085, 0.1) + ylim(-0.1,0.05) + geom_dotplot(binaxis='y', stackdir='center', dotsize=0.1, binwidth = 0.04)
p2 = ggplot(data, aes(x=C_prop)) + geom_line(aes(y=mean_t35_normalizedto28_avgred), color="blue") + xlab("C_prop") + ylab("Mean Average Red") + theme_bw()  + xlim(0.085, 0.1)
ggarrange(p1,p2)
p1 = ggplot(data, aes(x=C_prop)) + geom_line(aes(y=mean_t35_normalizedto28_pam), color="blue") + xlab("C_prop") + ylab("PAM") + theme_bw() + xlim(0.085, 0.1) + ylim(-0.1,0.05) + geom_dotplot(binaxis='y', stackdir='center')
p2 = ggplot(data, aes(x=C_prop)) + geom_line(aes(y=mean_t35_normalizedto28_avgred), color="blue") + xlab("C_prop") + ylab("Mean Average Red") + theme_bw()  + xlim(0.085, 0.1)
ggarrange(p1,p2)
p1 = ggplot(data, aes(x=C_prop)) + geom_line(aes(y=mean_t35_normalizedto28_pam), color="blue") + xlab("C_prop") + ylab("PAM") + theme_bw() + xlim(0.085, 0.1) + ylim(-0.1,0.05) + geom_dotplot(binaxis='y')
p2 = ggplot(data, aes(x=C_prop)) + geom_line(aes(y=mean_t35_normalizedto28_avgred), color="blue") + xlab("C_prop") + ylab("Mean Average Red") + theme_bw()  + xlim(0.085, 0.1)
ggarrange(p1,p2)
p1 = ggplot(data, aes(x=C_prop)) + geom_line(aes(y=mean_t35_normalizedto28_pam), color="blue") + xlab("C_prop") + ylab("PAM") + theme_bw() + xlim(0.085, 0.1) + ylim(-0.1,0.05)
p1 = ggplot(data, aes(x=C_prop)) + geom_line(aes(y=mean_t35_normalizedto28_pam), color="blue") + xlab("C_prop") + ylab("PAM") + theme_bw() + xlim(0.085, 0.1) + ylim(-0.1,0.05) + geom_point()
p2 = ggplot(data, aes(x=C_prop)) + geom_line(aes(y=mean_t35_normalizedto28_avgred), color="blue") + xlab("C_prop") + ylab("Mean Average Red") + theme_bw()  + xlim(0.085, 0.1)
ggarrange(p1,p2)
p1 = ggplot(data, aes(x=C_prop)) + geom_line(aes(y=mean_t35_normalizedto28_pam), color="blue") + xlab("C_prop") + ylab("PAM") + theme_bw() + xlim(0.085, 0.1) + ylim(-0.1,0.05) + geom_point(stat = "identity")
p2 = ggplot(data, aes(x=C_prop)) + geom_line(aes(y=mean_t35_normalizedto28_avgred), color="blue") + xlab("C_prop") + ylab("Mean Average Red") + theme_bw()  + xlim(0.085, 0.1)
ggarrange(p1,p2)
p1 = ggplot(data, aes(x=C_prop)) + geom_line(aes(y=mean_t35_normalizedto28_pam), color="blue") + xlab("C_prop") + ylab("PAM") + theme_bw() + xlim(0.085, 0.1) + ylim(-0.1,0.05) + geom_point(data=data,aes(x=C_prop,y=mean_t35_normalizedto28_pam))
p2 = ggplot(data, aes(x=C_prop)) + geom_line(aes(y=mean_t35_normalizedto28_avgred), color="blue") + xlab("C_prop") + ylab("Mean Average Red") + theme_bw()  + xlim(0.085, 0.1)
ggarrange(p1,p2)
p2 = ggplot(data, aes(x=C_prop)) + geom_line(aes(y=mean_t35_normalizedto28_avgred), color="red") + xlab("C_prop") + ylab("Mean Average Red") + theme_bw()  + xlim(0.085, 0.1) + geom_point(data=data,aes(x=C_prop,y=mean_t35_normalizedto28_avgred))
ggarrange(p1,p2)
p1 = ggplot(data, aes(x=C_prop)) + geom_line(aes(y=mean_t35_normalizedto28_pam), color="blue") + xlab("C_prop") + ylab("PAM") + theme_bw() + xlim(0.087, 0.1) + ylim(-0.1,0.05) + geom_point(data=data,aes(x=C_prop,y=mean_t35_normalizedto28_pam))
p2 = ggplot(data, aes(x=C_prop)) + geom_line(aes(y=mean_t35_normalizedto28_avgred), color="red") + xlab("C_prop") + ylab("Mean Average Red") + theme_bw()  + xlim(0.087, 0.1) + geom_point(data=data,aes(x=C_prop,y=mean_t35_normalizedto28_avgred))
ggarrange(p1,p2)
p1 = ggplot(data, aes(x=C_prop)) + geom_line(aes(y=mean_t35_normalizedto28_pam), color="blue") + xlab("C_prop") + ylab("PAM") + theme_bw() + xlim(0.087, 0.1) + ylim(-0.1,0.05) + geom_point(data=data,aes(x=C_prop,y=mean_t35_normalizedto28_pam))
p2 = ggplot(data, aes(x=C_prop)) + geom_line(aes(y=mean_t35_normalizedto28_avgred), color="red") + xlab("C_prop") + ylab("Mean Average Red") + theme_bw() + geom_point(data=data,aes(x=C_prop,y=mean_t35_normalizedto28_avgred))
p3 = ggplot(data, aes(x=C_prop)) + geom_line(aes(y=mean_t35_normalizedto28_pam), color="blue") + xlab("C_prop") + ylab("PAM") + theme_bw() + xlim(0.087, 0.1) + ylim(-0.1,0.05) + geom_point(data=data,aes(x=C_prop,y=mean_t35_normalizedto28_pam))
p4 = ggplot(data, aes(x=C_prop)) + geom_line(aes(y=mean_t35_normalizedto28_avgred), color="red") + xlab("C_prop") + ylab("Mean Average Red") + theme_bw() + geom_point(data=data,aes(x=C_prop,y=mean_t35_normalizedto28_avgred))
ggarrange(p1,p2,p3,p4)
p1 = ggplot(data, aes(x=C_prop)) + geom_line(aes(y=mean_t35_normalizedto28_pam), color="blue") + xlab("C_prop") + ylab("PAM") + theme_bw() + xlim(0.087, 0.1) + ylim(-0.1,0.05) + geom_point(data=data,aes(x=C_prop,y=mean_t35_normalizedto28_pam))
p2 = ggplot(data, aes(x=C_prop)) + geom_line(aes(y=mean_t35_normalizedto28_avgred), color="red") + xlab("C_prop") + ylab("Mean Average Red") + theme_bw()  + xlim(0.087, 0.1) + geom_point(data=data,aes(x=C_prop,y=mean_t35_normalizedto28_avgred))
p3 = ggplot(data, aes(x=C_prop)) + geom_line(aes(y=mean_t35_normalizedto28_pam), color="blue") + xlab("C_prop") + ylab("PAM") + theme_bw()  + ylim(-0.1,0.05) + geom_point(data=data,aes(x=C_prop,y=mean_t35_normalizedto28_pam))
p4 = ggplot(data, aes(x=C_prop)) + geom_line(aes(y=mean_t35_normalizedto28_avgred), color="red") + xlab("C_prop") + ylab("Mean Average Red") + theme_bw()  + geom_point(data=data,aes(x=C_prop,y=mean_t35_normalizedto28_avgred))
ggarrange(p1,p2,p3,p4)
p1 = ggplot(data, aes(x=C_prop)) + geom_line(aes(y=mean_t35_normalizedto28_pam), color="blue") + xlab("C_prop") + ylab("PAM") + theme_bw()  + ylim(-0.1,0.05) + geom_point(data=data,aes(x=C_prop,y=mean_t35_normalizedto28_pam))
p2 = ggplot(data, aes(x=C_prop)) + geom_line(aes(y=mean_t35_normalizedto28_avgred), color="red") + xlab("C_prop") + ylab("Mean Average Red") + theme_bw()  + geom_point(data=data,aes(x=C_prop,y=mean_t35_normalizedto28_avgred))
p3 = ggplot(data, aes(x=C_prop)) + geom_line(aes(y=mean_t35_normalizedto28_pam), color="blue") + xlab("C_prop") + ylab("PAM") + theme_bw() + xlim(0.087, 0.1) + ylim(-0.1,0.05) + geom_point(data=data,aes(x=C_prop,y=mean_t35_normalizedto28_pam))
p4 = ggplot(data, aes(x=C_prop)) + geom_line(aes(y=mean_t35_normalizedto28_avgred), color="red") + xlab("C_prop") + ylab("Mean Average Red") + theme_bw()  + xlim(0.087, 0.1) + geom_point(data=data,aes(x=C_prop,y=mean_t35_normalizedto28_avgred))
ggarrange(p1,p2,p3,p4)
p1 = ggplot(data, aes(x=C_prop)) + geom_line(aes(y=mean_t35_normalizedto28_pam), color="blue") + xlab("Log Proportion of Cladocopium") + ylab("Mean PAM Fv/Fm") + theme_bw()  + ylim(-0.1,0.05) + geom_point(data=data,aes(x=C_prop,y=mean_t35_normalizedto28_pam))
p2 = ggplot(data, aes(x=C_prop)) + geom_line(aes(y=mean_t35_normalizedto28_avgred), color="red") + xlab("Log Proportion of Cladocopium") + ylab("Mean Average Red Intensity") + theme_bw()  + geom_point(data=data,aes(x=C_prop,y=mean_t35_normalizedto28_avgred))
p3 = ggplot(data, aes(x=C_prop)) + geom_line(aes(y=mean_t35_normalizedto28_pam), color="blue") + xlab("Log Proportion of Cladocopium") + ylab("Mean PAM Fv/Fm") + theme_bw() + xlim(0.087, 0.1) + ylim(-0.1,0.05) + geom_point(data=data,aes(x=C_prop,y=mean_t35_normalizedto28_pam))
p4 = ggplot(data, aes(x=C_prop)) + geom_line(aes(y=mean_t35_normalizedto28_avgred), color="red") + xlab("Log Proportion of Cladocopium") + ylab("Mean Average Red Intensity") + theme_bw()  + xlim(0.087, 0.1) + geom_point(data=data,aes(x=C_prop,y=mean_t35_normalizedto28_avgred))
ggarrange(p1,p2,p3,p4)
ggsave("/Users/Melissa/Desktop/GitHub/Symbiont_qPCR/figures/symbiontCprop_bleaching.pdf", width = 6, height = 4)
p1 = ggplot(data, aes(x=C_prop)) + geom_line(aes(y=mean_t35_normalizedto28_pam), color="blue") + xlab("Log Proportion of Cladocopium") + ylab("Mean PAM Fv/Fm") + theme_bw()  + ylim(-0.07,0.05) + geom_point(data=data,aes(x=C_prop,y=mean_t35_normalizedto28_pam))
p2 = ggplot(data, aes(x=C_prop)) + geom_line(aes(y=mean_t35_normalizedto28_avgred), color="red") + xlab("Log Proportion of Cladocopium") + ylab("Mean Average Red Intensity") + theme_bw()  + geom_point(data=data,aes(x=C_prop,y=mean_t35_normalizedto28_avgred))
p3 = ggplot(data, aes(x=C_prop)) + geom_line(aes(y=mean_t35_normalizedto28_pam), color="blue") + xlab("Log Proportion of Cladocopium") + ylab("Mean PAM Fv/Fm") + theme_bw() + xlim(0.087, 0.1) + ylim(-0.07,0.05) + geom_point(data=data,aes(x=C_prop,y=mean_t35_normalizedto28_pam))
p4 = ggplot(data, aes(x=C_prop)) + geom_line(aes(y=mean_t35_normalizedto28_avgred), color="red") + xlab("Log Proportion of Cladocopium") + ylab("Mean Average Red Intensity") + theme_bw()  + xlim(0.087, 0.1) + geom_point(data=data,aes(x=C_prop,y=mean_t35_normalizedto28_avgred))
ggarrange(p1,p2,p3,p4)
p1 = ggplot(data, aes(x=C_prop)) + geom_line(aes(y=mean_t35_normalizedto28_pam), color="blue") + xlab("Log Proportion of Cladocopium") + ylab("Mean PAM Fv/Fm") + theme_bw()  + ylim(-0.06,0.05) + geom_point(data=data,aes(x=C_prop,y=mean_t35_normalizedto28_pam))
p2 = ggplot(data, aes(x=C_prop)) + geom_line(aes(y=mean_t35_normalizedto28_avgred), color="red") + xlab("Log Proportion of Cladocopium") + ylab("Mean Average Red Intensity") + theme_bw()  + geom_point(data=data,aes(x=C_prop,y=mean_t35_normalizedto28_avgred))
p3 = ggplot(data, aes(x=C_prop)) + geom_line(aes(y=mean_t35_normalizedto28_pam), color="blue") + xlab("Log Proportion of Cladocopium") + ylab("Mean PAM Fv/Fm") + theme_bw() + xlim(0.087, 0.1) + ylim(-0.06,0.05) + geom_point(data=data,aes(x=C_prop,y=mean_t35_normalizedto28_pam))
p4 = ggplot(data, aes(x=C_prop)) + geom_line(aes(y=mean_t35_normalizedto28_avgred), color="red") + xlab("Log Proportion of Cladocopium") + ylab("Mean Average Red Intensity") + theme_bw()  + xlim(0.087, 0.1) + geom_point(data=data,aes(x=C_prop,y=mean_t35_normalizedto28_avgred))
ggarrange(p1,p2,p3,p4)
ggsave("/Users/Melissa/Desktop/GitHub/Symbiont_qPCR/figures/symbiontCprop_bleaching.pdf", width = 6, height = 4)
install.packages("meme")
library(meme)
View(Colony)
setwd(dir = "~/Desktop/GitHub/Symbiont_qPCR/")
rm( list = ls())
graphics.off()
library(tidyr)
data <- read.csv("rawdata/2014data/2014data_04_26_21_ahyac31-36,38-43_50th.csv", header = F)
head(data)
data
View(data)
colnames(data) <- as.character(unlist(data[20,]))
head(data)
View(data)
data <- read.csv("rawdata/2014data/2014data_04_26_21_ahyac31-36,38-43_50th.csv", header = F)
View(data)
colnames(data) <- as.character(unlist(data[20,]))
data <- data[-c(1:20),]
head(data)
tail(data)
data <- spread(data, Fluor, Cq)
head(data)
#confirm neg control
data %>%
filter(Content == "Neg Ctrl")
data$Target <- NULL
data$Content <- NULL
data$Well <- NULL
head(data)
data$`Starting Quantity (SQ)` <- NULL
head(data)
tail(data)
write.csv(data,"cleandata/2014data/2014data_clean_04_26_21_ahyac31-36,38-43_50th.csv")
write.csv(data,"cleandata/2014data/2014data_clean_04_26_21_ahyac31-36,38-43_50th.csv", row.names = F)
setwd(dir = "~/Desktop/GitHub/Symbiont_qPCR/")
rm( list = ls())
graphics.off()
library(ggplot2)
library(dplyr)
library(tidyr)
library(mosaic)
library(RColorBrewer)
#read in all clean csv files
dat1 <- read.csv("cleandata/2014data/2014data_clean_04_26_21_ahyac31-36,38-43_50th.csv")
#bind data files together
#dat <- rbind(dat1,dat2)
nrow(dat)
head(dat)
#read in all clean csv files
dat <- read.csv("cleandata/2014data/2014data_clean_04_26_21_ahyac31-36,38-43_50th.csv")
head(dat)
dat$FAM <- as.numeric(dat$FAM)
dat$VIC <- as.numeric(dat$VIC)
View(dat)
dat <- dat[!(dat$Sample=="neg con"),]
View(dat)
dat$Site = "n"
View(dat)
dat$Site[1:24,] <- "Faga'tele"
dat$Site[1:24,]
dat$Site[c(1:24),]
dat[1:24,]
dat$Site(dat[1:24,]) <- "Faga'tele"
dat[1:24,]
dat[1:24,4] <- "Faga'tele"
dat[25:36,4] <- "Cannery"
dat_log <- dat
dat_log$FAM_log <- log10(dat_log$FAM)
dat_log$VIC_log <- log10(dat_log$VIC)
View(dat_log)
dat_ratio_log <- dat_log %>%
group_by(Sample, Site) %>%
summarize(FAM_log_mean = mean(FAM_log, na.rm = TRUE), VIC_log_mean = mean(VIC_log, na.rm = TRUE))
dat_ratio_log
View(dat_ratio_log)
dat_ratio_log$cellnum_C <- (2^(40 - dat_ratio_log$VIC_log_mean)) / 9
dat_ratio_log$cellnum_C[is.na(dat_ratio_log$VIC_log_mean)] <- (2^(40-10000000000000))
dat_ratio_log$cellnum_D <- (2^(40 - dat_ratio_log$FAM_log_mean)) / 1
View(dat_ratio_log)
dat_ratio_log$D_prop <- dat_ratio_log$cellnum_D / (dat_ratio_log$cellnum_C + dat_ratio_log$cellnum_D)
dat_ratio_log$C_prop <- dat_ratio_log$cellnum_C / (dat_ratio_log$cellnum_C + dat_ratio_log$cellnum_D)
dat_ratio_gather <- gather(dat_ratio_log, "Species", "Ratio", 7:8)
dat_ratio_gather$Ratio <- round(dat_ratio_gather$Ratio, digits = 4)
View(dat_ratio_gather)
View(dat_ratio_log)
View(dat_ratio_gather)
ggplot(dat_ratio_log, aes(x = Site, y = C_prop, fill = Site)) + geom_violin() + theme_bw()  +
scale_fill_brewer(palette = "Set3") + ylab("Log Proportion of Cladocopium") + xlab("") + geom_dotplot(binaxis='y', stackdir='center', dotsize=0.1, binwidth = 0.04)
dat_ratio_means <- dat_ratio_log %>%
group_by(Site) %>%
summarize(D_prop_avg = mean(D_prop), C_prop_avg = mean(C_prop))
View(dat_ratio_means)
dat_ratio_means <- gather(dat_ratio_means, "Species", "Ratio", 2:3)
dat_ratio_means$logRatio <- dat_ratio_means$Ratio
#plots mean proportions for each site
ggplot(dat_ratio_means, aes(x = Site, y = logRatio, fill = Species)) + geom_col() + theme_bw()  + ylab("Log Proportion of Durisdinium and Cladocopium") + scale_fill_manual(labels = c("Cladocopium", "Durisdinium"), values = c("violetred2", "royalblue3")) + xlab("") + theme(legend.title = element_blank())
dat$samplemonth = "n"
dat[1:36,5] <- "March"
View(dat)
ggplot(dat_ratio_log, aes(x = Site, y = C_prop, fill = Site)) + geom_violin() + theme_bw()  +
scale_fill_brewer(palette = "Set3") + ylab("Log Proportion of Cladocopium") + xlab("") + geom_dotplot(binaxis='y', stackdir='center', dotsize=0.1, binwidth = 0.04)
